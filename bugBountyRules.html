<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <title>Yahoo Bug Bounty Special Program 2.0 Rules</title>
    <link rel="stylesheet" type="text/css" href="stylesheets/cssbase-min.css">
    <link rel="stylesheet" type="text/css" href="stylesheets/cssreset-min.css">
    <link rel="stylesheet" href="stylesheets/security.css" type="text/css" />

    <!-- Bootstrap -->
    <link href="stylesheets/bootstrap.min.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->

    <link href="stylesheets/blog.css" rel="stylesheet">
    <link href="stylesheets/carousel.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9] >
      <script src="javascripts/html5shiv.min.js"></script>
      <script src="javascripts/respond.min.js"></script>
    <![endif]-->
  </head>

    <body>
    <div class="header">
      <h1 class="header-logo">
      </h1>
    </div>
    
        <div class="blog-masthead">
          <div class="container">
            <nav class="blog-nav">
              <a class="blog-nav-item " href="./">Home</a>
              <a class="blog-nav-item " href="./safejstemplating.html">Safe JS Templating</a>
              <a class="blog-nav-item " href="./gettingstart.html">Getting Started</a>
              <a class="blog-nav-item " href="./demosSecureHandlebars.html">Demos</a>
              <a class="blog-nav-item active" href="./bugBounty.html">Bug Bounty</a>
            </nav>
          </div>
        </div>

    <div class="container">
      <!-- grid system: http://getbootstrap.com/css/#grid -->
      <div class="row">
        <div class="col-md-12 blog-main">
          <h2 class="header-badge">Yahoo Bug Bounty Special Program 2.0 Rules</h2>
        </div> <!-- blog main -->

        <div class="col-md-12 blog-post">
          <h3>Products in Scope</h3>
          <br>
          <div class="col-md-6">
            <h4><a href="https://www.npmjs.com/package/xss-filters">Secure XSS Filters</a></h4>
            <p class="text-justify"><a href="https://www.npmjs.com/package/xss-filters">xss-filters</a> provides context-aware output sanitization filters to defend against Cross-Site Scripting (XSS). Check out the <a href="https://www.npmjs.com/package/xss-filters#api-documentations">API</a> for the full list of public contextual filters. Click <a href="./demosXssFilters.html">here</a> for a demo.</p>
          </div>
            <div class="col-md-6">
            <h4><a href="https://www.npmjs.com/package/secure-handlebars">Secure Handlebars</a></h4>
            <p class="text-justify"><a href="https://www.npmjs.com/package/secure-handlebars">secure-handlebars</a> performs static contextual analysis on handlebars templates, and applies contextual filtering to every output expression. Click <a href="./demosSecureHandlebars.html">here</a> for a demo.</p>
          </div>
        </div>

        <div class="col-md-12 blog-post">
          <h3>Qualified Vulnerability Reports</h3>
          <p class="text-justify">We are interested in knowing how these products can fail in defending against XSS in UTF-8 documents:</p>
          <br>
          <div class="col-md-6">
            <h4>Secure XSS Filters</h4>
            <p class="text-justify">A qualified vulnerability report must include a malicious input to bypass the filters, resulting in JavaScript execution in the desired execution contexts of the filters.</p>
            <p class="text-justify">When applied in their appropriate output contexts, the filters are designed to support desktop versions of Google Chrome 31 or above, Mozilla Firefox 31 or above, Microsoft Internet Explorer 7 or above, and Apple Safari 5.1 or above.</p>
          </div>
            <div class="col-md-6">
            <h4>Secure Handlebars</h4>
            <p class="text-justify">A qualified vulnerability report must include a malicious input and an Handlebars template, to which the filter(s) inserted for supported contexts can be bypassed by the input, resulting in JavaScript execution after compilation and data binding.</p>
            <p class="text-justify">More precisely, (1) secure-handlebars is correctly applied while throwing no errors nor warnings; and (2) it is vulnerable due to those automatically inserted filter(s), <i>that would otherwise be secured by the Handlebars default escaping filter</i>.</p>
            <p class="text-justify">Same as Secure XSS Filters, the filters are designed to support the same version of browsers.</p>
          </div>
          <p>In addition to the <a href="https://hackerone.com/yahoo">common rules and terms</a>, click <a href="#unqualified" onclick="document.getElementById('unqualified').classList.remove('hide')">here</a> for the specific known issues of these products that are excluded from monetary rewards.</p>
        </div>

        <div id="unqualified" class="col-md-12 blog-post hide">
          <h3>Unqualified Vulnerabilities</h3>
          <p class="text-justify">Vulnerabilities that fall outside of the scope of qualified vulnerability reports will be reviewed on a case-by-case basis and may not earn monetary rewards. Below are some known issues that are excluded from monetary rewards:</p>

          <br>
          <h4>Unsupported Encoding and Contexts</h4>
          <p class="text-justify">We have largely provided filters for use under the HTML 5 contexts. JavaScript and Cascade Style Sheet (CSS) are however not fully supported yet. The products MUST ONLY be applied to UTF-8-encoded documents.</p>

          <p class="text-justify">For XSS filters, DON'T apply any filters inside any scriptable contexts, i.e., &lt;script>, &lt;style>, &lt;object>, &lt;embed>, and &lt;svg> tags as well as style="" and onXXX="" (e.g., onclick) attributes. It is known to be insecure to permit untrusted input inside a scriptable context.</p>

          <p class="text-justify">For Secure Handlebars, any malicious inputs found executing in the unsupported contexts are unqualified for this program. When the strict mode option is disabled, we now handle them by falling back to use the default Handlebars escaping filter and give a warning. When the strict mode is set, we throw exceptions instead of warnings during the contextual analysis. Hence, our claim is that using secure-handlebars is always no worse than the original Handlebars. Click <a href="https://github.com/yahoo/secure-handlebars#supported-contexts">here</a> for the supported contexts.</p>

          <br>
          <h4>Partial Templates and Raw Block in Handlebars</h4>
          <p class="text-justify">Most JavaScript template engine supports the feature of partial to facilitate sharing of common layouts. In our current implementation, we treat each partial file as a standalone template file to process. It means that the initial and final state of each partial file is in the <a href="https://html.spec.whatwg.org/multipage/syntax.html#data-state">Data State</a> as defined in the HTML5 Specification. Any partial file that does not start and return in the Data State does not qualify for this program.</p>
          <p class="text-justify">Since Handlebars v3.0, the feature of raw block is introduced for developers to handle unprocessed mustache blocks. During the contextual analysis, we do not touch anything within the raw block and hold the same assumption as in partial handling. Therefore, the initial and final state of the raw block is the Data State.</p>

          <br>
          <h4>Broken Template</h4>
          <p class="text-justify">In our implementation, we decouple the templating analysis and AST constructions from the Handlebars parser. Only relaxed syntax validation is applied. Templates that would cause Handlebars compilation process or <a href="https://www.npmjs.com/package/context-parser">Context-parser</a> to throw errors are generally unqualified for the reward, since such an error has already prohibited any data binding and rendering, and will not result in XSS vulnerabilities.</p>
          <p class="text-justify">Nevertheless, we would still love to learn how broken templates can be creatively crafted that you think deserve our special attention. Please report such kind of issues through <a href="https://github.com/yahoo/secure-handlebars/issues">github issue page</a>.</p>

          <br>
          <h4>JavaScript in Template</h4>
          <p class="text-justify">A report is unqualified if (malicious) JavaScript code already existed in the template. It is because for legitimate use, the template is considered an honest and trusted input. This program is targeting vulnerability reports that can bypass filters through the input data.</p>

          <br>
          <h4>Static Template Analysis</h4>
          <p class="text-justify">Our static contextual analysis is based only on the template. The limitations of this approach is known, and here're some of them:</p>

          <p class="text-justify">
            Example 1: <code>&lt;img &lbrace;&lbrace;output1}}&lbrace;&lbrace;output2}}/&gt;</code>
          </p>

          <p class="text-justify">In Example 1, both output expressions are in the attribute name context, which is NOT among the <a href="https://github.com/yahoo/secure-handlebars#supported-contexts">supported ones</a>. Imagine an attacker supplies <code>href=</code> as the value for <code>&lbrace;{output1}}</code>. Unfortunately, the default Handlebars escaping filter being used for such an unsupported context has kept the input intact. If the developer ignores our warning and proceed compiling the template, the output context of <code>&lbrace;{output2}}</code> can be dynamically altered as a URI in an unquoted attribute value context. It is known that the static approach cannot apply an appropriate contextual filter in this situation, although this is still no worse than using the original Handlebars only.

          <p class="text-justify">
            Example 2: <code>&lt;a href="&lbrace;&lbrace;output1}}&lbrace;&lbrace;output2}}"&gt;link&lt;/a&gt;</code> or <code>&lt;a href="java&lbrace;{output3}}">link&lt;/a></code>
          </p>

          <p class="text-justify">In example 2, the blacklist URI protocol filter can be bypassed by splitting the malicious protocol such as javascript: into two.</p>
        </div>

        <div class="col-md-12 blog-post">
          <h3>Reward Amounts</h3>
          <p class="text-justify">
          You will be paid for qualifying submissions, depending on the severity and complexity of the issue. These amounts will generally be <a href="http://yahoodevelopers.tumblr.com/post/65622522325/the-bug-bounty-program-is-now-live">DOUBLED</a> for vulnerabilities specific to the products in scope. Rewards are granted entirely at the discretion of Yahoo.</p>
        </div>

        <div class="col-md-12 blog-post">
          <h3>Investigating and Reporting</h3>
          <p class="text-justify">Please submit your reports through <a href="https://hackerone.com/yahoo">Yahoo HackerOne</a> and please add a subject prefix "<b>xss-filters</b>" or "<b>secure-handlebars</b>" for triaging. Your submission will be reviewed within 30 days.</p>
        </div>

        <div class="col-md-12 blog-post">
          <div class="security-cta">
            <form action="./demosXssFilters.html" method="get"> 
              <button type="submit">Continue</button>
            </form>
          </div>
        </div><!-- blog-post -->

      </div><!-- row -->
    </div><!-- container -->

    <div class="footer">
    <a href="https://policies.yahoo.com/us/en/yahoo/privacy/index.htm" target="_blank">Privacy</a> |
    <a href="https://policies.yahoo.com/us/en/yahoo/terms/utos/index.htm" target="_blank">Legal</a>
    </div>
        <!-- Bootstrap core JavaScript
        ================================================== -->
        <!-- Placed at the end of the document so the pages load faster -->
        <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
        <script src="javascripts/jquery.min.js"></script>
        <!-- Include all compiled plugins (below), or include individual files as needed -->
        <script src="javascripts/bootstrap.min.js"></script>
    
        <script src="javascripts/docs.min.js"></script>
        <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
        <script src="javascripts/ie10-viewport-bug-workaround.js"></script>
    
      </body>
    </html>
